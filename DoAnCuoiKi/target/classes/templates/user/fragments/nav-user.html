<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <!-- =======================================================
        * Template Name: Logis
        * Template URL: https://bootstrapmade.com/logis-bootstrap-logistics-website-template/
        * Updated: Jun 29 2024 with Bootstrap v5.3.3
        * Author: BootstrapMade.com
        * License: https://bootstrapmade.com/license/
        ======================================================== -->

    <!-- ======= Header ======= -->
    <!-- Thẻ nav được giữ nguyên từ phiên bản trước, đã sửa lỗi null và link cart -->
    <nav th:fragment="nav" class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
        <div class="container">
            <!-- Logo -->
            <a class="navbar-brand d-flex align-items-center me-auto" th:href="@{/user/home}"> <!-- Link về trang chủ user -->
                <img src="https://placehold.co/150x40/E8F7F4/333?text=AloTra+Logo" alt="AloTra Logo" style="height: 40px; width: auto;" th:src="@{/assets/img/logo.png}" onerror="this.src='https://placehold.co/150x40/E8F7F4/333?text=AloTra+Logo'">
            </a>

            <!-- Nút Toggler cho mobile -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Menu chính -->
            <div class="collapse navbar-collapse" id="mainNavbar">
                <!-- Links căn giữa -->
                 <ul class="navbar-nav mx-auto mb-2 mb-lg-0">
                     <li class="nav-item">
                         <!-- Sử dụng biến currentUri an toàn -->
                         <a class="nav-link" th:href="@{/user/home}" th:classappend="${#strings.startsWith(#strings.defaultString(currentUri,''), '/user/home') ? 'active' : ''}">Trang Chủ</a>
                     </li>
                     <li class="nav-item">
                         <a class="nav-link" th:href="@{/user/menu}" th:classappend="${#strings.startsWith(#strings.defaultString(currentUri,''), '/user/menu') ? 'active' : ''}">Menu</a>
                     </li>
                     <li class="nav-item">
                         <!-- Đã sửa lỗi link Profile -->
                         <a class="nav-link" th:href="@{/user/profile}" th:classappend="${#strings.startsWith(#strings.defaultString(currentUri,''), '/user/profile') ? 'active' : ''}">
                             Hồ sơ cá nhân
                         </a>
                     </li>
                     <li class="nav-item">
                          <!-- Đã sửa lỗi link Lịch sử -->
                          <a class="nav-link" th:href="@{/user/history}" th:classappend="${#strings.startsWith(#strings.defaultString(currentUri,''), '/user/history') ? 'active' : ''}">Lịch sử</a>
                     </li>
                 </ul>


                <!-- Khu vực Hành động (Tìm kiếm, Giỏ hàng, Yêu thích...) -->
                 <div class="header-actions d-flex align-items-center">
                    <!-- Form Tìm kiếm -->
                    <form class="search-form d-none d-lg-block me-3 position-relative">
                        <input type="text" class="form-control form-control-sm rounded-pill" placeholder="Tìm kiếm...">
                        <button type="submit" class="btn position-absolute end-0 top-50 translate-middle-y border-0 bg-transparent text-muted px-2" style="line-height: 1;"><i class="bi bi-search"></i></button>
                    </form>

                    <!-- Icon Yêu thích -->
                    <a href="#" class="action-icon me-3 position-relative" title="Sản phẩm yêu thích">
                        <i class="bi bi-heart fs-5"></i>
                        <!-- <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size: 0.6rem;">
                            3 <span class="visually-hidden">sản phẩm yêu thích</span>
                        </span> -->
                    </a>

                    <!-- Icon Giỏ hàng (Cập nhật link + hiển thị số lượng) -->
                    <a th:href="@{/user/cart}" class="action-icon me-3 position-relative" title="Giỏ hàng"> <!-- Sửa lại me-3 -->
                        <i class="bi bi-cart fs-5"></i>
                        <span th:if="${cartItemCount != null and cartItemCount > 0}"
                              class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-primary"
                              style="font-size: 0.6rem;"
                              th:text="${cartItemCount}">
                            0 <span class="visually-hidden">sản phẩm trong giỏ</span>
                        </span>
                    </a>

                    <!-- Nút Đăng xuất -->
                     <a th:href="@{/alotra/login}" class="btn btn-outline-secondary btn-sm" title="Đăng xuất"> <!-- Tạm link về trang login -->
                         <i class="bi bi-box-arrow-right"></i>
                     </a>
                 </div>

            </div> <!-- /.collapse -->
        </div> <!-- /.container -->
    </nav>
    <!-- End Header -->
</body>
</html>